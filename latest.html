<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Latest Pressed Number</title>

<!-- Firebase compat SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
  html,body{height:100%;margin:0}
  body{display:flex;align-items:center;justify-content:center;background:#111;color:#fff;font-family:-apple-system,system-ui,Segoe UI,Roboto,Arial,sans-serif}
  .wrap{text-align:center}
  .label{font-size:3.5vw;opacity:.7;margin-bottom:1rem}
  .num{font-size:25vw;line-height:1;font-weight:800;letter-spacing:0.02em;transition:transform .1s ease}
  .state{font-size:4vw;opacity:.8;margin-top:1rem}
  @media (max-width:800px){
    .label{font-size:6vw}
    .num{font-size:35vw}
    .state{font-size:6vw}
  }
  .on{color:#00e676}
  .off{color:#ff5252}
</style>
</head>
<body>
<div class="wrap">
  <div class="label">Latest Pressed</div>
  <div id="num" class="num">—</div>
  <div id="state" class="state">waiting…</div>
</div>

<script>
// ===== Replace with your Firebase config (using your existing project) =====
const firebaseConfig = {
  apiKey: "AIzaSyCWWnMsge75Q3_MDF9Aj9wo4C5KD6RVGfw",
  authDomain: "q-matic-b7d77.firebaseapp.com",
  databaseURL: "https://q-matic-b7d77-default-rtdb.firebaseio.com",
  projectId: "q-matic-b7d77",
  storageBucket: "q-matic-b7d77.firebasestorage.app",
  messagingSenderId: "908187704899",
  appId: "1:908187704899:web:b8bcf33cda90bafe81bef6",
  measurementId: "G-VT1P6V5TEY"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const numEl = document.getElementById('num');
const stateEl = document.getElementById('state');

// Listen to any change; show the most recently changed number
db.ref('grid').on('child_changed', snap => {
  const n = parseInt(snap.key, 10);
  const isOn = !!snap.val();
  render(n, isOn);
});

// Fallback on first load to something meaningful
db.ref('grid').once('value').then(snap => {
  const data = snap.val() || {};
  let lastOn = -1;
  for (let k in data){
    if (data[k]) lastOn = Math.max(lastOn, parseInt(k,10));
  }
  if (lastOn > 0) render(lastOn, true);
});

function render(n, isOn){
  numEl.textContent = n;
  numEl.style.transform = 'scale(1.04)';
  setTimeout(()=> numEl.style.transform = 'scale(1)', 120);
  stateEl.textContent = isOn ? 'ON' : 'OFF';
  stateEl.className = 'state ' + (isOn ? 'on' : 'off');
}
</script>
</body>
</html>
